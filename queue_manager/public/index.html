<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ALPEN.BOT SONGQ</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<div id="login-status" class="status-bar" style="display:none">
  <div class="status-user">
    <div id="login-avatar" class="status-avatar" aria-hidden="true"></div>
    <div class="status-info">
      <span id="login-name" class="status-name"></span>
      <span id="login-channel" class="status-channel"></span>
    </div>
  </div>
  <div class="status-actions">
    <button id="logout-btn" class="status-action">log out</button>
    <button id="logout-perm-btn" class="status-action danger">forget &amp; log out</button>
  </div>
</div>
<div id="landing" class="landing">
  <h1>ALPEN.BOT SONGQ</h1>
  <button id="login-btn">log in with Twitch</button>
  <div id="channel-list" class="channel-list"></div>
</div>

<div id="app" style="display:none">
  <div class="wrap">
    <div class="header">
      <div class="brand">Queue Manager</div>
      <span id="ch-badge" class="badge">channel: ?</span>
      <span id="bot-status" class="badge" hidden>bot: unknown</span>
      <button id="reg-btn" style="display:none"></button>
    </div>

    <div class="grid">
      <div class="card">
        <div class="tabs">
          <button id="tab-queue" class="tab active">Queue</button>
          <button id="tab-playlists" class="tab">Playlists</button>
          <button id="tab-users" class="tab">Users</button>
          <button id="tab-settings" class="tab">Settings</button>
          <button id="tab-events" class="tab">Events</button>
          <button id="tab-overlays" class="tab">Overlays</button>
        </div>

        <div id="queue-view">
          <div class="queue-layout">
            <div class="preview-column">
              <div class="preview-card">
                <div class="section-header">
                  <h3 class="section-title">YouTube Preview</h3>
                  <button id="preview-toggle" class="collapse-toggle" type="button" aria-expanded="true" aria-controls="preview-content">Hide preview</button>
                </div>
                <div id="preview-content" class="collapsible-content">
                  <div id="preview-video" class="preview-video empty">
                    <iframe id="preview-frame" title="YouTube preview" src="about:blank" loading="lazy" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                    <div id="preview-message" class="preview-message">Select a request to load YouTube Music matches.</div>
                  </div>
                  <div class="preview-link-group">
                    <label for="preview-url">Video link</label>
                    <div class="preview-link-row">
                      <input id="preview-url" type="text" value="" readonly aria-readonly="true"/>
                      <button id="preview-copy" type="button" disabled>Copy</button>
                    </div>
                  </div>
                  <div class="preview-results">
                    <div class="preview-results-header">
                      <span class="preview-results-title">YouTube Music results</span>
                      <span id="preview-status" class="preview-status muted"></span>
                    </div>
                    <div id="preview-results" class="preview-results-list"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="queue-column">
              <div class="section-header">
                <h2 class="section-title">Active Queue</h2>
                <button id="queue-toggle" class="collapse-toggle" type="button" aria-expanded="true" aria-controls="queue-content">Hide queue</button>
              </div>
              <div id="queue-content" class="collapsible-content">
                <div id="queue" class="queue"></div>
              </div>
            </div>
          </div>
          <div class="footer">
            <button id="archive-btn">Archive Stream</button>
            <button id="mute-btn">Toggle Requests</button>
          </div>
        </div>

        <div id="playlists-view" style="display:none">
          <h2>Playlists</h2>
          <form id="playlist-form" class="playlist-form">
            <div class="playlist-form-row">
              <label for="playlist-url">Playlist link</label>
              <input id="playlist-url" type="url" required placeholder="https://www.youtube.com/playlist?list=..." />
            </div>
            <div class="playlist-form-row">
              <label for="playlist-visibility">Visibility</label>
              <select id="playlist-visibility">
                <option value="public">Public</option>
                <option value="unlisted">Unlisted</option>
              </select>
            </div>
            <div class="playlist-form-row">
              <label for="playlist-keywords">Keywords</label>
              <input id="playlist-keywords" type="text" placeholder="Separate with commas or spaces" />
              <p class="muted playlist-form-hint">Use commas or spaces to enter multiple keywords. Chat can request them with <code>!random keyword</code>.</p>
            </div>
            <div class="playlist-form-actions">
              <button type="submit">Add playlist</button>
              <span id="playlist-status" class="playlist-status muted" role="status" hidden></span>
            </div>
          </form>
          <div id="playlists" class="playlists-list"></div>
        </div>

        <div id="users-view" style="display:none">
          <h2>Users</h2>
          <div id="users" class="queue"></div>
        </div>

        <div id="settings-view" style="display:none">
          <h2>Settings</h2>
          <div id="settings"></div>
        </div>

        <div id="events-view" style="display:none">
          <div class="events-header">
            <h2 class="section-title">Channel Events</h2>
            <div class="events-controls">
              <span id="event-status" class="event-status">Disconnected</span>
              <label class="event-autoscroll">
                <input id="event-autoscroll" type="checkbox" checked />
                Auto-scroll
              </label>
              <button id="event-clear" type="button">Clear</button>
            </div>
          </div>
          <div id="event-feed" class="event-feed" role="log" aria-live="polite" aria-relevant="additions"></div>
        </div>

        <div id="overlays-view" style="display:none">
          <h2>Overlay Builder</h2>
          <p class="muted">Design OBS browser sources that stay in sync with your live queue and channel events. Choose an overlay family, customize the options, and copy the generated link.</p>
          <div class="overlay-builder" aria-live="polite">
            <div class="overlay-controls">
              <div id="overlay-channel-warning" class="overlay-warning" hidden>Select a channel to generate overlay links.</div>
              <div class="overlay-family-tabs" role="tablist" aria-label="Overlay type">
                <button id="overlay-family-tab-queue" class="overlay-family-tab active" type="button" role="tab" aria-selected="true" data-overlay-family-tab="queue">Queue overlays</button>
                <button id="overlay-family-tab-events" class="overlay-family-tab" type="button" role="tab" aria-selected="false" data-overlay-family-tab="events">Event overlays</button>
              </div>
              <div class="overlay-section" role="tabpanel" aria-labelledby="overlay-family-tab-queue" data-overlay-family="queue">
                <p class="overlay-section-intro muted">Display your current queue in different layouts and themes.</p>
                <label>
                  Overlay size &amp; layout
                  <select id="overlay-layout">
                    <option value="bumped" data-width="400" data-height="300">Bumped songs (400×300)</option>
                    <option value="full" data-width="400" data-height="800">Full queue (400×800)</option>
                    <option value="banner" data-width="1920" data-height="200">Horizontal banner (1920×200)</option>
                  </select>
                </label>
                <label>
                  Color scheme
                  <select id="overlay-theme">
                    <option value="violet">Midnight Violet</option>
                    <option value="ocean">Nordic Ocean</option>
                    <option value="sunset">Evening Sunset</option>
                    <option value="mint">Aurora Mint</option>
                  </select>
                </label>
              </div>
              <div class="overlay-section" role="tabpanel" aria-labelledby="overlay-family-tab-events" data-overlay-family="events" hidden>
                <p class="overlay-section-intro muted">Create stylized alerts that follow channel events in real time.</p>
                <label>
                  Event layout
                  <select id="event-overlay-layout">
                    <option value="ticker">Marquee ticker</option>
                    <option value="stacked">Stacked cards</option>
                    <option value="minimal">Minimal badge</option>
                  </select>
                </label>
                <label>
                  Color palette
                  <select id="event-overlay-theme">
                    <option value="violet">Midnight Violet</option>
                    <option value="ocean">Nordic Ocean</option>
                    <option value="ember">Festival Ember</option>
                    <option value="mint">Aurora Mint</option>
                  </select>
                </label>
                <label>
                  Detail intensity
                  <select id="event-overlay-detail">
                    <option value="minimal">Minimal</option>
                    <option value="standard" selected>Standard</option>
                    <option value="max">Maximum</option>
                  </select>
                </label>
                <label>
                  Size &amp; position preset
                  <select id="event-overlay-preset">
                    <option value="top-right" data-width="560" data-height="360">Top right (560×360)</option>
                    <option value="bottom-left" data-width="640" data-height="420">Bottom left (640×420)</option>
                    <option value="full-stage" data-width="1920" data-height="1080">Full stage (1920×1080)</option>
                  </select>
                </label>
                <label>
                  Meme effects (optional)
                  <select id="event-overlay-meme">
                    <option value="none">None</option>
                    <option value="confetti">Confetti burst</option>
                    <option value="airhorn">Airhorn stingers</option>
                    <option value="bongo">Bongo cat bounce</option>
                  </select>
                </label>
              </div>
              <div class="overlay-link-group">
                <label for="overlay-url">Overlay link</label>
                <div class="overlay-link-row">
                  <input id="overlay-url" type="text" readonly value="" aria-readonly="true"/>
                  <button id="overlay-copy" type="button">Copy</button>
                </div>
                <div id="overlay-dimensions" class="overlay-dimensions muted"></div>
              </div>
            </div>
            <div class="overlay-preview">
              <div class="overlay-preview-frame">
                <iframe id="overlay-preview" title="Overlay preview" loading="lazy"></iframe>
                <div class="overlay-preview-hints">
                  <div class="overlay-preview-hint muted" data-overlay-family-hint="queue">Preview background is transparent in OBS. Queue overlays update whenever the song list changes.</div>
                  <div class="overlay-preview-hint muted" data-overlay-family-hint="events" hidden>Preview background is transparent in OBS. Event overlays animate when new alerts arrive.</div>
                </div>
              </div>
            </div>
          </div>
          <p class="overlay-hint muted">Add a new Browser Source in OBS, paste the link, and use the recommended size. The overlay updates itself whenever your channel data changes.</p>
        </div>
      </div>
    </div>
  </div>
</div>
  <script src="config.js"></script>
  <script src="queue_manager.js"></script>
</body>
</html>
